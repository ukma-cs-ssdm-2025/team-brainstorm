# üõ°Ô∏è –ó–≤—ñ—Ç –ø—Ä–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ ‚Äî Library API

## üîê 1. –ñ–æ—Ä—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–∏–π SECRET_KEY (SEC01)

**–†–∏–∑–∏–∫:** –í–∏—Å–æ–∫–∏–π  
**–§–∞–π–ª:** `src/core/security.py`

Fault: –Ø –∑–∞—à–∏–≤ —Å–µ–∫—Ä–µ—Ç —É –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥.
Error: –°–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∞ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π –∫–ª—é—á –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.
Failure: –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–∏—Ç—ñ–∫ —Ç–æ–∫–µ–Ω—ñ–≤ —ñ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ API.
Severity: üî¥ –í–∏—Å–æ–∫–∏–π

### ‚ùå –í—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥
```python
SECRET_KEY = "super_secret_key"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 60
```

### ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∫–æ–¥ 
```python
import os
from secrets import token_urlsafe

SECRET_KEY = os.getenv("SECRET_KEY")
if not SECRET_KEY:
    SECRET_KEY = token_urlsafe(32)
    print("[WARN] –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç–∏–º—á–∞—Å–æ–≤–∏–π SECRET_KEY (—Ä–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–∫–∏)")

ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 60
```
> –°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ —É –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞; —Ç–∏–º—á–∞—Å–æ–≤–∏–π –∫–ª—é—á –¥–æ–∑–≤–æ–ª–µ–Ω–æ –ª–∏—à–µ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏.

–§–µ–¥—ñ–Ω –í–æ–ª–æ–¥–∏–º–∏—Ä
---


## üßÆ 2. –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–Ω–∏–≥ (BUG01)

**–†–∏–∑–∏–∫:** –°–µ—Ä–µ–¥–Ω—ñ–π  
**–§–∞–π–ª:** `src/api/routes/books.py`

Fault: –ü–æ–º–∏–ª–∫–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–µ—ñ—Å–Ω—É—é—á–æ–≥–æ –∞–±–æ –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ–≥–æ –ø–æ–ª—è reserved.
Error: –û–±—á–∏—Å–ª–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–Ω–∏–≥ –¥–∞–≤–∞–ª–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 0 –ø—Ä–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –≤—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏–º—ñ—Ä–Ω–∏–∫—ñ–≤).
Failure: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏–≤ –ø–æ–º–∏–ª–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é ‚Äî –∫–Ω–∏–≥–∏ –º–æ–≥–ª–∏ –∑–¥–∞–≤–∞—Ç–∏—Å—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–º–∏.
Severity: üü° –°–µ—Ä–µ–¥–Ω—ñ–π

### ‚ùå –í—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥
```python
if book["total_copies"] - book.get("reserved", 0) > 0:
```

### ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∫–æ–¥
```python
if book["total_copies"] - book.get("reserved_count", 0) > 0:
```

> –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–µ –ø–æ–ª–µ `reserved_count` –∑–∞–º—ñ—Å—Ç—å –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ–≥–æ `reserved`.

–§–µ–¥—ñ–Ω –í–æ–ª–æ–¥–∏–º–∏—Ä
---




## üß© –ü—ñ–¥—Å—É–º–∫–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è

| –ö–æ–¥ | –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å | –†–∏–∑–∏–∫ | –°—Ç–∞—Ç—É—Å |
|------|----------------|------|---------|
| SEC01 | –ñ–æ—Ä—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–∏–π SECRET_KEY | üî¥ –í–∏—Å–æ–∫–∏–π | ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ |
| BUG01 | reserved ‚Üí reserved_count | üü° –°–µ—Ä–µ–¥–Ω—ñ–π | ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ |


---
